<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
<style>
    body {
     
        margin: 0;
        background:black;
    }
</style>

<div class="fixed text-white ml-2 mt-1 select-none"><span>Score: </span><span id="scoreEL">0</span></div>
<div id="modelEl" class="fixed inset-0 flex items-center justify-center">
    <div class="bg-white max-w-md w-full p-6 text-center">
        <h1 id="bigScore" class="text-4xl font-bold leading-none">0</h1>
        <p class="text-sm tex-gray mb-4">Points</p>
        <div>
        <button id = "startGameBtn" class="bg-blue-500 text-white text-sm w-full py-3 rounded-full">Start Game</button>
    </div>
    </div>
</div>

<canvas></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.8.0/gsap.min.js" 
integrity="sha512-eP6ippJojIKXKO8EPLtsUMS+/sAGHGo1UN/38swqZa1ypfcD4I0V/ac5G3VzaHfDaklFmQLEs51lhkkVaqg60Q==" 
crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script >const canvas = document.querySelector('canvas')
    const c = canvas.getContext('2d')
        canvas.width = innerWidth
        canvas.height = innerHeight
    const scoreEL = document.querySelector('#scoreEL')
    const startGameBtn = document.querySelector('#startGameBtn')
    const modelEl = document.querySelector('#modelEl')
    const bigScore = document.querySelector('#bigScore')
    
        class Player {
            constructor(x,y,radius,color){
                this.x = x
                this.y = y
                this.radius = radius
                this.color = color
            }
    
            draw() {
                c.beginPath()
                c.arc(this.x,this.y,this.radius,0, Math.PI * 2, true)
                c.fillStyle = this.color
                c.fill()
            }
        }
    
        class Projectile {
            constructor(x,y,radius,color,velocity){
                this.x = x
                this.y = y
                this.radius = radius
                this.color = color
                this.velocity = velocity
            }
    
            draw() {
                c.beginPath()
                c.arc(this.x,this.y,this.radius,0, Math.PI * 2, true)
                c.fillStyle = this.color
                c.fill()
            }
    
            update() {
                this.draw()
                this.x = this.x + this.velocity.x
                this.y = this.y + this.velocity.y
            }
        }
    
        class Enemy {
            constructor(x,y,radius,color,velocity){
                this.x = x
                this.y = y
                this.radius = radius
                this.color = color
                this.velocity = velocity
            }
    
            draw() {
                c.beginPath()
                c.arc(this.x,this.y,this.radius,0, Math.PI * 2, true)
                c.fillStyle = this.color
                c.fill()
            }
    
            update() {
                this.draw()
                this.x = this.x + this.velocity.x
                this.y = this.y + this.velocity.y
            }
        }
    
        const friction = 0.99
        class Particle {
            constructor(x,y,radius,color,velocity){
                this.x = x
                this.y = y
                this.radius = radius
                this.color = color
                this.velocity = velocity
                this.alpha = 1
            }
    
            draw() {
                c.save()
                c.globalAlpha = this.alpha
                c.beginPath()
                c.arc(this.x,this.y,this.radius,0, Math.PI * 2, true)
                c.fillStyle = this.color
                c.fill()
                c.restore()
            }
    
            update() {
                this.draw()
                this.velocity.x *= friction
                this.velocity.y *= friction
                this.x = this.x + this.velocity.x
                this.y = this.y + this.velocity.y
                this.alpha -= 0.01
            }
        }
    
        function spawnEnemies(){
            setInterval(()=>{
                const radius =  Math.random() * (30 - 4) + 4      
                
                let x
                let y 
    
                if(Math.random() < 0.5){
                     x = Math.random() < 0.5 ? 0 - radius : canvas.width + radius
                   y = Math.random() * canvas.height
                     // y = Math.random() < 0.5 ? 0 - radius : canvas.height + radius
                   
                } else {
                    x = Math.random() * canvas.width
                    y = Math.random() < 0.5 ? 0 - radius : canvas.height + radius
                    
                }
               const color = `hsl(${Math.random()*360}, 50%, 50%)`
                
                const angle = Math.atan2(
                    canvas.height / 2 - y,
                    canvas.width / 2 - x)
        
                 const velocity = {
                     x: Math.cos(angle),
                     y: Math.sin(angle)
                 }
        
                enemies.push(new Enemy(x,y,radius,color, velocity))
               },1000)
        }
    
        const x = canvas.width / 2
        const y = canvas.height / 2
    
        let player = new Player(x,y, 30, 'white')
        let  projectiles = []
        let  enemies = []
        let  particles = []
     
     
        function init(){
            player = new Player(x,y, 30, 'white')
            projectiles = []
            enemies = []
            particles = []
            score = 0
            scoreEL.innerHTML = score
            bigScore.innerHTML = score
        }
    
        let animationId
        let score = 0
        function animate() {
        
            animationId = requestAnimationFrame(animate)
       
            c.fillStyle = 'rgba(0, 0, 0, 0.1)'
            c.fillRect(0,0, canvas.width,canvas.height)
           
            player.draw()
    
    
            particles.forEach((particle,index) => {
                if (particle.alpha <= 0){
                    particles.splice(index,1)
                } else {
                    particle.update()
                }
            });
    
    
            projectiles.forEach((projectile,index) => 
                {
                projectile.update()
    
                if (projectile.x - projectile.radius < 0 || 
                    projectile.x - projectile.radius > canvas.width || 
                    projectile.y + projectile.radius < 0 || 
                    projectile.y - projectile.radius > canvas.height
                    ){
                        setTimeout ( () =>{
                        projectiles.splice(index,1)
                    }, 0)
                }
    
                });
            enemies.forEach((enemy,index) => {
                enemy.update()
                const dist = Math.hypot(player.x - enemy.x, player.y - enemy.y)
                
                if (dist - enemy.radius - player.radius < 1) {
    //end game
                  cancelAnimationFrame(animationId)
                  modelEl.style.display = 'flex'
                  bigScore.innerHTML = score
                  
                }
    
                projectiles.forEach((projectile,pindex) => {
                   const dist = Math.hypot(projectile.x - enemy.x, projectile.y - enemy.y)
    //objects touch 
                if (dist - enemy.radius - projectile.radius < 1) 
                {
    // Score
                    
    // Create explosions
                        for (let i = 0; i < enemy.radius * 2; i++) {
                            particles.push(new Particle(projectile.x,
                                                        projectile.y,
                                                         Math.random() * 3,
                                                        enemy.color, {
                                                            x: (Math.random() - 0.5) * (Math.random() * 4),
                                                            y: (Math.random() - 0.5) * (Math.random() * 4)
                                                        }))
                            
                        }
                        if(enemy.radius -10 >5){
                            score += 100
                            scoreEL.innerHTML = score
                            gsap.to(enemy,{
                                radius: enemy.radius - 10
                            })
                            setTimeout ( () =>{
                        
                                projectiles.splice(pindex,1)
                            }, 0)
    // Remove from screen
                        }else{
                            score += 250
                            scoreEL.innerHTML = score
                    
                        setTimeout ( () =>{
                            enemies.splice(index,1)
                            projectiles.splice(pindex,1)
                        }, 0)
                    }
                    
                    
                }
                })
            })
        }
        addEventListener('click', (event) =>
        {
          {
              const angle = Math.atan2(
                event.clientY - canvas.height / 2,
                event.clientX-canvas.width / 2)
    
             const velocity = {
                 x: Math.cos(angle)*6,
                 y: Math.sin(angle)*6
             }
    
              projectiles.push(new Projectile(canvas.width / 2,
                canvas.height/2,
                5,
                'white',
                velocity))
          }
        
        })

        addEventListener('touch', (event) =>
        {
          {
              const angle = Math.atan2(
                event.clientY - canvas.height / 2,
                event.clientX-canvas.width / 2)
    
             const velocity = {
                 x: Math.cos(angle)*6,
                 y: Math.sin(angle)*6
             }
    
              projectiles.push(new Projectile(canvas.width / 2,
                canvas.height/2,
                5,
                'white',
                velocity))
          }
        
        })
    
        startGameBtn.addEventListener('click', (event)=>{
        init()
        animate()
        spawnEnemies()
        modelEl.style.display = 'none'
        
        })</script>